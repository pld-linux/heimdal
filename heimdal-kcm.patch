diff -ur heimdal-1.2.1/kcm/cache.c heimdal-1.2.1-kcm/kcm/cache.c
--- heimdal-1.2.1/kcm/cache.c	2008-07-28 14:04:49.000000000 +0200
+++ heimdal-1.2.1-kcm/kcm/cache.c	2009-07-09 19:36:19.041440040 +0200
@@ -559,11 +559,12 @@
 
     ret = KRB5_CC_NOTFOUND;
 
-    for (c = &ccache->creds; *c != NULL; c = &(*c)->next) {
+    for (c = &ccache->creds; *c != NULL; ) {
 	if (krb5_compare_creds(context, whichfields, mcreds, &(*c)->cred)) {
-	    remove_cred(context, c);
+	    remove_cred(context, c); // remove_cred does c = &(*c)->next
 	    ret = 0;
-	}
+	} else
+	    c = &(*c)->next;
     }
 
     return ret;
